#!/usr/bin/env node

/**
 * OBD-II Generic DTC Database Generator
 *
 * Generates the comprehensive standard OBD-II DTC code database as JSON files.
 * Covers all SAE J2012 standard codes:
 *   P0xxx-P3xxx (Powertrain)
 *   B0xxx-B3xxx (Body)
 *   C0xxx-C3xxx (Chassis)
 *   U0xxx-U3xxx (Network/Communication)
 *
 * Output: data/dtc/obdii-*.json files
 * Usage: node scripts/generate-obdii-dtc.js
 */

const fs = require('fs')
const path = require('path')

const DTC_DIR = path.join(__dirname, '..', 'data', 'dtc')

// Ensure output directory exists
if (!fs.existsSync(DTC_DIR)) {
  fs.mkdirSync(DTC_DIR, { recursive: true })
}

// ============================================================================
// POWERTRAIN CODES (P0xxx - P0999 SAE Standard)
// ============================================================================

const powertrainGenericCodes = [
  // P00xx - Fuel and Air Metering
  { code: "P0001", description: "Fuel Volume Regulator Control Circuit/Open", subcategory: "fuel_and_air", severity: "high", common_causes: ["Faulty fuel volume regulator", "Open circuit in wiring", "Poor connection"], diagnostic_method: "OBD-II scanner, check wiring and regulator", fix_reference: "Inspect wiring, test regulator, replace if faulty" },
  { code: "P0002", description: "Fuel Volume Regulator Control Circuit Range/Performance", subcategory: "fuel_and_air", severity: "high", common_causes: ["Fuel volume regulator failure", "Fuel contamination", "Wiring issue"], diagnostic_method: "OBD-II scanner, monitor fuel pressure", fix_reference: "Test fuel pressure, check regulator operation, replace if needed" },
  { code: "P0003", description: "Fuel Volume Regulator Control Circuit Low", subcategory: "fuel_and_air", severity: "high", common_causes: ["Short to ground", "Faulty regulator", "Damaged wiring"], diagnostic_method: "OBD-II scanner, check circuit voltage", fix_reference: "Check wiring for shorts, test regulator, replace" },
  { code: "P0004", description: "Fuel Volume Regulator Control Circuit High", subcategory: "fuel_and_air", severity: "high", common_causes: ["Short to battery voltage", "Faulty regulator", "Wiring issue"], diagnostic_method: "OBD-II scanner, check circuit voltage", fix_reference: "Check wiring for short to power, test regulator" },
  { code: "P0005", description: "Fuel Shutoff Valve Control Circuit/Open", subcategory: "fuel_and_air", severity: "high", common_causes: ["Faulty shutoff valve", "Open circuit", "Connector issue"], diagnostic_method: "OBD-II scanner, test valve operation", fix_reference: "Check valve wiring, test solenoid, replace if needed" },
  { code: "P0006", description: "Fuel Shutoff Valve Control Circuit Low", subcategory: "fuel_and_air", severity: "high", common_causes: ["Short to ground", "Faulty shutoff valve", "Wiring damage"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Inspect wiring for ground short, replace valve" },
  { code: "P0007", description: "Fuel Shutoff Valve Control Circuit High", subcategory: "fuel_and_air", severity: "high", common_causes: ["Short to voltage", "Faulty shutoff valve", "Connector corrosion"], diagnostic_method: "OBD-II scanner, check circuit voltage", fix_reference: "Check for power short, test valve, replace" },
  { code: "P0008", description: "Engine Position System Performance - Bank 1", subcategory: "ignition", severity: "high", common_causes: ["Timing chain stretch", "Faulty VVT system", "Cam/crank correlation issue"], diagnostic_method: "OBD-II scanner, check timing marks", fix_reference: "Inspect timing chain/belt, check VVT solenoid, verify timing" },
  { code: "P0009", description: "Engine Position System Performance - Bank 2", subcategory: "ignition", severity: "high", common_causes: ["Timing chain stretch", "Faulty VVT system", "Cam/crank correlation issue"], diagnostic_method: "OBD-II scanner, check timing marks", fix_reference: "Inspect timing chain/belt, check VVT solenoid" },
  { code: "P0010", description: "Intake Camshaft Position Actuator Circuit/Open - Bank 1", subcategory: "ignition", severity: "medium", common_causes: ["Faulty VVT solenoid", "Open circuit", "Low oil pressure"], diagnostic_method: "OBD-II scanner, test VVT solenoid", fix_reference: "Check oil level/pressure, test solenoid, replace if needed" },
  { code: "P0011", description: "Intake Camshaft Position Timing Over-Advanced - Bank 1", subcategory: "ignition", severity: "medium", common_causes: ["VVT solenoid stuck", "Oil flow blockage", "Timing chain stretch"], diagnostic_method: "OBD-II scanner, check cam timing", fix_reference: "Change oil, clean VVT solenoid, check timing chain" },
  { code: "P0012", description: "Intake Camshaft Position Timing Over-Retarded - Bank 1", subcategory: "ignition", severity: "medium", common_causes: ["VVT solenoid stuck", "Low oil pressure", "Timing chain stretch"], diagnostic_method: "OBD-II scanner, check cam timing", fix_reference: "Change oil, clean/replace VVT solenoid, inspect timing" },
  { code: "P0013", description: "Exhaust Camshaft Position Actuator Circuit/Open - Bank 1", subcategory: "ignition", severity: "medium", common_causes: ["Faulty exhaust VVT solenoid", "Open wiring", "Low oil pressure"], diagnostic_method: "OBD-II scanner, test exhaust VVT", fix_reference: "Test solenoid, check wiring, verify oil pressure" },
  { code: "P0014", description: "Exhaust Camshaft Position Timing Over-Advanced - Bank 1", subcategory: "ignition", severity: "medium", common_causes: ["Exhaust VVT solenoid stuck", "Oil contamination", "Timing issue"], diagnostic_method: "OBD-II scanner, check cam timing", fix_reference: "Oil change, clean VVT solenoid, check timing" },
  { code: "P0015", description: "Exhaust Camshaft Position Timing Over-Retarded - Bank 1", subcategory: "ignition", severity: "medium", common_causes: ["Exhaust VVT solenoid stuck", "Low oil", "Timing chain wear"], diagnostic_method: "OBD-II scanner, check cam timing", fix_reference: "Verify oil level, clean/replace VVT solenoid" },
  { code: "P0016", description: "Crankshaft Position - Camshaft Position Correlation - Bank 1 Sensor A", subcategory: "ignition", severity: "high", common_causes: ["Timing chain jumped", "VVT failure", "Sensor fault"], diagnostic_method: "OBD-II scanner, check timing marks", fix_reference: "Verify timing, check sensors, inspect chain/belt" },
  { code: "P0017", description: "Crankshaft Position - Camshaft Position Correlation - Bank 1 Sensor B", subcategory: "ignition", severity: "high", common_causes: ["Timing chain jumped", "VVT failure", "Sensor fault"], diagnostic_method: "OBD-II scanner, check timing marks", fix_reference: "Verify timing, check exhaust cam sensor, inspect chain" },
  { code: "P0018", description: "Crankshaft Position - Camshaft Position Correlation - Bank 2 Sensor A", subcategory: "ignition", severity: "high", common_causes: ["Timing chain jumped", "VVT failure", "Sensor fault"], diagnostic_method: "OBD-II scanner, check timing marks", fix_reference: "Verify bank 2 timing, check sensors" },
  { code: "P0019", description: "Crankshaft Position - Camshaft Position Correlation - Bank 2 Sensor B", subcategory: "ignition", severity: "high", common_causes: ["Timing chain jumped", "VVT failure", "Sensor fault"], diagnostic_method: "OBD-II scanner, check timing marks", fix_reference: "Verify bank 2 timing, check sensors" },
  { code: "P0020", description: "Intake Camshaft Position Actuator Circuit/Open - Bank 2", subcategory: "ignition", severity: "medium", common_causes: ["Faulty VVT solenoid", "Open circuit", "Low oil pressure"], diagnostic_method: "OBD-II scanner, test VVT solenoid", fix_reference: "Check oil, test solenoid, inspect wiring" },
  { code: "P0021", description: "Intake Camshaft Position Timing Over-Advanced - Bank 2", subcategory: "ignition", severity: "medium", common_causes: ["VVT solenoid stuck", "Oil flow issue", "Timing chain"], diagnostic_method: "OBD-II scanner, check cam timing", fix_reference: "Oil change, clean VVT, check timing" },
  { code: "P0022", description: "Intake Camshaft Position Timing Over-Retarded - Bank 2", subcategory: "ignition", severity: "medium", common_causes: ["VVT solenoid stuck", "Low oil pressure", "Timing issue"], diagnostic_method: "OBD-II scanner, check cam timing", fix_reference: "Verify oil, clean/replace VVT solenoid" },
  { code: "P0023", description: "Exhaust Camshaft Position Actuator Circuit/Open - Bank 2", subcategory: "ignition", severity: "medium", common_causes: ["Faulty exhaust VVT solenoid", "Open wiring", "Oil issue"], diagnostic_method: "OBD-II scanner, test solenoid", fix_reference: "Test VVT solenoid, check wiring, verify oil" },
  { code: "P0024", description: "Exhaust Camshaft Position Timing Over-Advanced - Bank 2", subcategory: "ignition", severity: "medium", common_causes: ["VVT stuck open", "Oil contamination", "Timing chain"], diagnostic_method: "OBD-II scanner, check cam timing", fix_reference: "Oil change, clean VVT, inspect timing" },
  { code: "P0025", description: "Exhaust Camshaft Position Timing Over-Retarded - Bank 2", subcategory: "ignition", severity: "medium", common_causes: ["VVT stuck closed", "Low oil", "Chain stretch"], diagnostic_method: "OBD-II scanner, check cam timing", fix_reference: "Check oil, replace VVT solenoid, inspect chain" },
  // P00xx continued - Fuel metering
  { code: "P0030", description: "Heated Oxygen Sensor Heater Control Circuit - Bank 1 Sensor 1", subcategory: "emission", severity: "medium", common_causes: ["Blown heater fuse", "Faulty O2 sensor heater", "Wiring open"], diagnostic_method: "OBD-II scanner, check heater circuit", fix_reference: "Check fuse, test heater resistance, replace O2 sensor" },
  { code: "P0031", description: "HO2S Heater Control Circuit Low - Bank 1 Sensor 1", subcategory: "emission", severity: "medium", common_causes: ["Short to ground", "Faulty O2 sensor", "Wiring damage"], diagnostic_method: "OBD-II scanner, test heater circuit", fix_reference: "Check wiring for ground short, replace sensor" },
  { code: "P0032", description: "HO2S Heater Control Circuit High - Bank 1 Sensor 1", subcategory: "emission", severity: "medium", common_causes: ["Short to voltage", "Faulty O2 sensor", "Wiring issue"], diagnostic_method: "OBD-II scanner, test heater circuit", fix_reference: "Check wiring for short to power, replace sensor" },
  { code: "P0033", description: "Turbo/Supercharger Bypass Valve Control Circuit", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Faulty bypass valve", "Wiring issue", "Vacuum leak"], diagnostic_method: "OBD-II scanner, test bypass valve", fix_reference: "Check valve operation, inspect wiring, fix vacuum leaks" },
  { code: "P0034", description: "Turbo/Supercharger Bypass Valve Control Circuit Low", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to ground", "Faulty valve solenoid", "Wiring damage"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Inspect wiring, test solenoid, replace if needed" },
  { code: "P0035", description: "Turbo/Supercharger Bypass Valve Control Circuit High", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to power", "Faulty valve solenoid", "Connector issue"], diagnostic_method: "OBD-II scanner, check circuit voltage", fix_reference: "Check wiring for power short, test solenoid" },
  { code: "P0036", description: "HO2S Heater Control Circuit - Bank 1 Sensor 2", subcategory: "emission", severity: "medium", common_causes: ["Blown fuse", "Faulty downstream O2 heater", "Wiring open"], diagnostic_method: "OBD-II scanner, test heater circuit", fix_reference: "Check fuse, test heater, replace downstream O2" },
  { code: "P0037", description: "HO2S Heater Control Circuit Low - Bank 1 Sensor 2", subcategory: "emission", severity: "low", common_causes: ["Short to ground", "Faulty O2 sensor", "Wiring issue"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Inspect wiring, replace downstream O2 sensor" },
  { code: "P0038", description: "HO2S Heater Control Circuit High - Bank 1 Sensor 2", subcategory: "emission", severity: "low", common_causes: ["Short to voltage", "Faulty O2 sensor", "Wiring fault"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace downstream O2 sensor" },
  // Turbo/Supercharger
  { code: "P0039", description: "Turbo/Supercharger Bypass Valve Control Circuit Range/Performance", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Bypass valve sticking", "Actuator worn", "Boost leak"], diagnostic_method: "OBD-II scanner, check boost pressure", fix_reference: "Test valve movement, check actuator, fix boost leaks" },
  { code: "P0040", description: "O2 Sensor Signals Swapped - Bank 1 Sensor 1 / Bank 2 Sensor 1", subcategory: "emission", severity: "medium", common_causes: ["O2 sensors connected to wrong bank", "Wiring crossed"], diagnostic_method: "OBD-II scanner, verify sensor locations", fix_reference: "Swap O2 sensor connectors to correct positions" },
  { code: "P0041", description: "O2 Sensor Signals Swapped - Bank 1 Sensor 2 / Bank 2 Sensor 2", subcategory: "emission", severity: "medium", common_causes: ["Downstream O2 sensors swapped", "Wiring crossed"], diagnostic_method: "OBD-II scanner, verify sensor locations", fix_reference: "Correct downstream O2 sensor connections" },
  { code: "P0042", description: "HO2S Heater Control Circuit - Bank 1 Sensor 3", subcategory: "emission", severity: "low", common_causes: ["Faulty third O2 heater", "Fuse issue", "Wiring open"], diagnostic_method: "OBD-II scanner, test heater circuit", fix_reference: "Check fuse, test heater, replace sensor" },
  { code: "P0043", description: "HO2S Heater Control Circuit Low - Bank 1 Sensor 3", subcategory: "emission", severity: "low", common_causes: ["Short to ground", "Faulty heater element"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Inspect wiring, replace O2 sensor" },
  { code: "P0044", description: "HO2S Heater Control Circuit High - Bank 1 Sensor 3", subcategory: "emission", severity: "low", common_causes: ["Short to voltage", "Faulty heater element"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace O2 sensor" },
  // P005x - Variable Valve Timing
  { code: "P0050", description: "HO2S Heater Control Circuit - Bank 2 Sensor 1", subcategory: "emission", severity: "medium", common_causes: ["Blown fuse", "Faulty O2 heater", "Wiring issue"], diagnostic_method: "OBD-II scanner, test heater", fix_reference: "Check fuse, test heater resistance, replace" },
  { code: "P0051", description: "HO2S Heater Control Circuit Low - Bank 2 Sensor 1", subcategory: "emission", severity: "medium", common_causes: ["Short to ground", "Faulty O2 sensor"], diagnostic_method: "OBD-II scanner, test circuit", fix_reference: "Check wiring, replace O2 sensor" },
  { code: "P0052", description: "HO2S Heater Control Circuit High - Bank 2 Sensor 1", subcategory: "emission", severity: "medium", common_causes: ["Short to voltage", "Faulty O2 sensor"], diagnostic_method: "OBD-II scanner, test circuit", fix_reference: "Check wiring, replace O2 sensor" },
  { code: "P0053", description: "HO2S Heater Resistance - Bank 1 Sensor 1", subcategory: "emission", severity: "medium", common_causes: ["O2 heater resistance out of spec", "Aging sensor"], diagnostic_method: "OBD-II scanner, measure heater resistance", fix_reference: "Replace O2 sensor" },
  { code: "P0054", description: "HO2S Heater Resistance - Bank 1 Sensor 2", subcategory: "emission", severity: "low", common_causes: ["Downstream O2 heater worn", "Resistance drift"], diagnostic_method: "OBD-II scanner, measure heater resistance", fix_reference: "Replace downstream O2 sensor" },
  { code: "P0055", description: "HO2S Heater Resistance - Bank 1 Sensor 3", subcategory: "emission", severity: "low", common_causes: ["Third O2 heater worn", "High resistance"], diagnostic_method: "OBD-II scanner, measure resistance", fix_reference: "Replace O2 sensor" },
  { code: "P0056", description: "HO2S Heater Control Circuit - Bank 2 Sensor 2", subcategory: "emission", severity: "low", common_causes: ["Blown fuse", "Faulty heater", "Wiring open"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check fuse, replace downstream O2" },
  { code: "P0057", description: "HO2S Heater Control Circuit Low - Bank 2 Sensor 2", subcategory: "emission", severity: "low", common_causes: ["Short to ground", "Faulty sensor"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace O2 sensor" },
  { code: "P0058", description: "HO2S Heater Control Circuit High - Bank 2 Sensor 2", subcategory: "emission", severity: "low", common_causes: ["Short to voltage", "Faulty sensor"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace O2 sensor" },
  { code: "P0059", description: "HO2S Heater Resistance - Bank 2 Sensor 1", subcategory: "emission", severity: "medium", common_causes: ["O2 heater worn", "Resistance out of spec"], diagnostic_method: "OBD-II scanner, measure resistance", fix_reference: "Replace O2 sensor" },
  { code: "P0060", description: "HO2S Heater Resistance - Bank 2 Sensor 2", subcategory: "emission", severity: "low", common_causes: ["Downstream O2 heater worn"], diagnostic_method: "OBD-II scanner, measure resistance", fix_reference: "Replace downstream O2 sensor" },
  { code: "P0061", description: "HO2S Heater Resistance - Bank 2 Sensor 3", subcategory: "emission", severity: "low", common_causes: ["Third O2 heater worn"], diagnostic_method: "OBD-II scanner, measure resistance", fix_reference: "Replace O2 sensor" },
  { code: "P0062", description: "HO2S Heater Control Circuit - Bank 2 Sensor 3", subcategory: "emission", severity: "low", common_causes: ["Blown fuse", "Faulty heater", "Wiring open"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check fuse, replace O2 sensor" },
  { code: "P0063", description: "HO2S Heater Control Circuit Low - Bank 2 Sensor 3", subcategory: "emission", severity: "low", common_causes: ["Short to ground"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace sensor" },
  { code: "P0064", description: "HO2S Heater Control Circuit High - Bank 2 Sensor 3", subcategory: "emission", severity: "low", common_causes: ["Short to voltage"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace sensor" },
  { code: "P0065", description: "Air Assisted Injector Control Range/Performance", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Air pump failure", "Injector air circuit blockage"], diagnostic_method: "OBD-II scanner, check air injection", fix_reference: "Test air pump, check air lines, clean injectors" },
  { code: "P0066", description: "Air Assisted Injector Control Circuit or Circuit Low", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Faulty air pump relay", "Wiring open"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Test relay, check wiring, replace air pump" },
  { code: "P0067", description: "Air Assisted Injector Control Circuit High", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to voltage", "Relay stuck"], diagnostic_method: "OBD-II scanner, check circuit voltage", fix_reference: "Test relay, check wiring" },
  { code: "P0068", description: "MAP/MAF - Throttle Position Correlation", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Dirty throttle body", "Intake leak", "Faulty MAP or TPS"], diagnostic_method: "OBD-II scanner, compare MAP/MAF with TPS", fix_reference: "Clean throttle body, check for intake leaks, test sensors" },
  { code: "P0069", description: "Manifold Absolute Pressure - Barometric Pressure Correlation", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Faulty MAP sensor", "BARO sensor issue", "Vacuum leak"], diagnostic_method: "OBD-II scanner, compare readings", fix_reference: "Test MAP sensor, check for vacuum leaks" },
  { code: "P0070", description: "Ambient Air Temperature Sensor Circuit", subcategory: "fuel_and_air", severity: "low", common_causes: ["Faulty ambient temp sensor", "Wiring issue"], diagnostic_method: "OBD-II scanner, check sensor", fix_reference: "Test sensor resistance, replace if needed" },
  { code: "P0071", description: "Ambient Air Temperature Sensor Range/Performance", subcategory: "fuel_and_air", severity: "low", common_causes: ["Sensor location issue", "Faulty sensor"], diagnostic_method: "OBD-II scanner, compare with actual temp", fix_reference: "Check sensor location, replace sensor" },
  { code: "P0072", description: "Ambient Air Temperature Sensor Circuit Low", subcategory: "fuel_and_air", severity: "low", common_causes: ["Short to ground", "Faulty sensor"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace sensor" },
  { code: "P0073", description: "Ambient Air Temperature Sensor Circuit High", subcategory: "fuel_and_air", severity: "low", common_causes: ["Open circuit", "Disconnected sensor"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check connection, replace sensor" },
  { code: "P0074", description: "Ambient Air Temperature Sensor Circuit Intermittent", subcategory: "fuel_and_air", severity: "low", common_causes: ["Loose connection", "Intermittent wiring"], diagnostic_method: "OBD-II scanner, wiggle test", fix_reference: "Secure connections, repair wiring" },
  { code: "P0075", description: "Intake Valve Control Solenoid Circuit - Bank 1", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Faulty IVCS solenoid", "Wiring issue", "Low oil"], diagnostic_method: "OBD-II scanner, test solenoid", fix_reference: "Check oil, test solenoid, replace if needed" },
  { code: "P0076", description: "Intake Valve Control Solenoid Circuit Low - Bank 1", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to ground", "Faulty solenoid"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace solenoid" },
  { code: "P0077", description: "Intake Valve Control Solenoid Circuit High - Bank 1", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to voltage", "Faulty solenoid"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace solenoid" },
  { code: "P0078", description: "Exhaust Valve Control Solenoid Circuit - Bank 1", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Faulty EVCS solenoid", "Wiring open", "Oil issue"], diagnostic_method: "OBD-II scanner, test solenoid", fix_reference: "Check oil, test solenoid, replace" },
  { code: "P0079", description: "Exhaust Valve Control Solenoid Circuit Low - Bank 1", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to ground", "Faulty solenoid"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace solenoid" },
  { code: "P0080", description: "Exhaust Valve Control Solenoid Circuit High - Bank 1", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to voltage", "Faulty solenoid"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace solenoid" },
  { code: "P0081", description: "Intake Valve Control Solenoid Circuit - Bank 2", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Faulty solenoid", "Wiring issue", "Low oil pressure"], diagnostic_method: "OBD-II scanner, test solenoid", fix_reference: "Check oil, test solenoid, replace" },
  { code: "P0082", description: "Intake Valve Control Solenoid Circuit Low - Bank 2", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to ground", "Faulty solenoid"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace solenoid" },
  { code: "P0083", description: "Intake Valve Control Solenoid Circuit High - Bank 2", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to voltage", "Faulty solenoid"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace solenoid" },
  { code: "P0084", description: "Exhaust Valve Control Solenoid Circuit - Bank 2", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Faulty solenoid", "Wiring open", "Oil issue"], diagnostic_method: "OBD-II scanner, test solenoid", fix_reference: "Check oil, test solenoid, replace" },
  { code: "P0085", description: "Exhaust Valve Control Solenoid Circuit Low - Bank 2", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to ground", "Faulty solenoid"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace solenoid" },
  { code: "P0086", description: "Exhaust Valve Control Solenoid Circuit High - Bank 2", subcategory: "fuel_and_air", severity: "medium", common_causes: ["Short to voltage", "Faulty solenoid"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace solenoid" },
  { code: "P0087", description: "Fuel Rail/System Pressure Too Low", subcategory: "fuel_and_air", severity: "high", common_causes: ["Weak fuel pump", "Clogged fuel filter", "Fuel pressure regulator failure", "Fuel line restriction"], diagnostic_method: "OBD-II scanner, test fuel pressure", fix_reference: "Test fuel pressure, replace fuel filter, check pump" },
  { code: "P0088", description: "Fuel Rail/System Pressure Too High", subcategory: "fuel_and_air", severity: "high", common_causes: ["Faulty fuel pressure regulator", "Blocked return line", "Stuck relief valve"], diagnostic_method: "OBD-II scanner, test fuel pressure", fix_reference: "Check return line, test regulator, replace if needed" },
  { code: "P0089", description: "Fuel Pressure Regulator Performance", subcategory: "fuel_and_air", severity: "high", common_causes: ["Worn fuel pressure regulator", "Contaminated fuel", "Regulator diaphragm leak"], diagnostic_method: "OBD-II scanner, monitor fuel pressure", fix_reference: "Test regulator, replace if pressure erratic" },
  { code: "P0090", description: "Fuel Pressure Regulator Control Circuit", subcategory: "fuel_and_air", severity: "high", common_causes: ["Faulty regulator solenoid", "Wiring issue", "ECU fault"], diagnostic_method: "OBD-II scanner, check regulator circuit", fix_reference: "Test solenoid, check wiring, replace regulator" },
  { code: "P0091", description: "Fuel Pressure Regulator Control Circuit Low", subcategory: "fuel_and_air", severity: "high", common_causes: ["Short to ground", "Faulty regulator"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace regulator" },
  { code: "P0092", description: "Fuel Pressure Regulator Control Circuit High", subcategory: "fuel_and_air", severity: "high", common_causes: ["Short to voltage", "Faulty regulator"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace regulator" },
  { code: "P0093", description: "Fuel System Leak Detected - Large Leak", subcategory: "fuel_and_air", severity: "critical", common_causes: ["Fuel line crack", "Injector seal leak", "Rail connection loose"], diagnostic_method: "OBD-II scanner, visual inspection for fuel leaks", fix_reference: "SAFETY: Inspect all fuel connections, repair leaks immediately" },
  { code: "P0094", description: "Fuel System Leak Detected - Small Leak", subcategory: "fuel_and_air", severity: "high", common_causes: ["Minor fuel line seep", "Injector O-ring leak", "Fuel cap issue"], diagnostic_method: "OBD-II scanner, fuel pressure decay test", fix_reference: "Check fuel connections, replace injector O-rings, check cap" },
  { code: "P0095", description: "Intake Air Temperature Sensor 2 Circuit", subcategory: "fuel_and_air", severity: "low", common_causes: ["Faulty IAT2 sensor", "Wiring issue"], diagnostic_method: "OBD-II scanner, test sensor", fix_reference: "Test sensor resistance, replace if needed" },
  { code: "P0096", description: "Intake Air Temperature Sensor 2 Circuit Range/Performance", subcategory: "fuel_and_air", severity: "low", common_causes: ["Sensor drift", "Heat soak issue"], diagnostic_method: "OBD-II scanner, compare readings", fix_reference: "Replace IAT2 sensor" },
  { code: "P0097", description: "Intake Air Temperature Sensor 2 Circuit Low", subcategory: "fuel_and_air", severity: "low", common_causes: ["Short to ground", "Faulty sensor"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check wiring, replace sensor" },
  { code: "P0098", description: "Intake Air Temperature Sensor 2 Circuit High", subcategory: "fuel_and_air", severity: "low", common_causes: ["Open circuit", "Disconnected"], diagnostic_method: "OBD-II scanner, check circuit", fix_reference: "Check connection, replace sensor" },
  { code: "P0099", description: "Intake Air Temperature Sensor 2 Circuit Intermittent/Erratic", subcategory: "fuel_and_air", severity: "low", common_causes: ["Loose connection", "Intermittent fault"], diagnostic_method: "OBD-II scanner, wiggle test", fix_reference: "Secure connections, replace sensor" },
]

// Format all codes with category field
function formatCodes(codes, category) {
  return codes.map(code => ({
    ...code,
    category,
    diagnostic_method: code.diagnostic_method || "OBD-II scanner",
    fix_reference: code.fix_reference || "Refer to service manual"
  }))
}

// Write the first batch
const batch1 = formatCodes(powertrainGenericCodes, 'powertrain')
fs.writeFileSync(
  path.join(DTC_DIR, 'obdii-powertrain-P00xx.json'),
  JSON.stringify(batch1, null, 2)
)
console.log(`Written: obdii-powertrain-P00xx.json (${batch1.length} codes)`)
console.log('Run additional generation scripts for remaining ranges.')
console.log('Total generic codes written this batch: ' + batch1.length)
